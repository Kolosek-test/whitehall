<% content_for :page_title, @contactable.name %>
<% content_for :title, @contactable.name %>
<% content_for :context, organisation_context_block(current_user, @contactable) %>
<% content_for :title_margin_bottom, 4 %>

<p class="govuk-body">
  <%= view_on_website_link_for @contactable, class: "govuk-link" %>
</p>

<%= render "components/secondary_navigation", {
  aria_label: "Contacts navigation tabs",
  items: secondary_navigation_tabs_items(@contactable, request.path)
} %>

<%= render "govuk_publishing_components/components/heading", {
  text: "Contacts",
  margin_bottom: 6,
} %>

<%= render "govuk_publishing_components/components/button", {
  text: "Add contact",
  href: new_polymorphic_path([:admin, @contactable, Contact.new]),
  margin_bottom: 6
} %>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <% if @contactable.contacts.present? %>
      <%= render "govuk_publishing_components/components/tabs", {
        tabs: [
          *(
            if @contactable.contacts.reject(&:foi?).present?
              [{
                 id: "general_and_media_contacts",
                 title: "General and media contacts",
                 label: "General and media contacts",
                 content: render(@contactable.contacts.reject(&:foi?), contactable: @contactable) || content_tag(:p, 'No contacts')
               }]
            end),
          *(
            if @contactable.contacts.select(&:foi?).present?
              [{
                 id: "freedom_of_information_contacts",
                 title: "Freedom of information contacts",
                 label: "Freedom of information contacts",
                 content: render(@contactable.contacts.select(&:foi?), contactable: @contactable) || content_tag(:p, 'No contacts')
               }]
            end),
        ]
      }
      %>
    <% else %>
      <%= render "govuk_publishing_components/components/inset_text", {
        text: "No Contacts"
      } %>
    <% end %>

  </div>
</div>
